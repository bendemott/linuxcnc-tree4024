# Generated by PNCconf at Fri Feb  1 14:36:33 2019
# If you make changes to this file, they will be
# overwritten when you run PNCconf again

[EMC]
MACHINE = tree_4024
DEBUG = 0

[ZBRAKE]
# settings for custom zbrake component
START_DELAY = 0.1
ERROR_INPUTS = 1
LOG_LEVEL = INFO

[DISPLAY]
# add GladeVCP panel as a tab next to Preview/DRO:
# test with gladevcp -c iopanel -u ./iopanel_gladevcp.py ./iopanel.glade
EMBED_TAB_NAME=io-status
# EMBED_TAB_COMMAND=halcmd loadusr -Wn iopanel gladevcp -U component=mega2560 -c iopanel -u ./iopanel_gladevcp.py ./iopanel.glade
EMBED_TAB_COMMAND=halcmd loadusr gladevcp -c iopanel -U component=mega2560  -u ./iopanel_gladevcp.py -x {XID} ./iopanel.glade

# add a right-hand tab with spindle info
#GLADEVCP=halcmd loadusr gladevcp -c spindleui -U asdf=asdf  -u ./spindle_gladevcp.py -x {XID} ./iopanel.glade
GLADEVCP=-u ./spindle_gladevcp.py ./spindleui.glade

DISPLAY = axis
POSITION_OFFSET = RELATIVE
POSITION_FEEDBACK = ACTUAL
MAX_FEED_OVERRIDE = 1.000000
MAX_SPINDLE_OVERRIDE = 1.000000
MIN_SPINDLE_OVERRIDE = 0.500000
INTRO_GRAPHIC = linuxcnc.gif
INTRO_TIME = 2
PROGRAM_PREFIX = /home/cnc/linuxcnc/nc_files
INCREMENTS = 100mm 25mm 5mm 1mm .5mm .1mm .05mm .01mm .005mm
##### FEED RATES #################################
##### VELOCITIES ################################
## The book states these values, although they are questionable
##   Feed Rate: 1-5000 mm/min (16.6 - 83.3 mm/sec)
##  Rapid Rate: 22k mm/min (366mm/sec)
## For Feed Rates - you need some overhead in the movement speed (usually 10%)
## The original controls settings appeared to have 30% of overhead in their max jog speed

# DEFAULT_LINEAR_VELOCITY: The default velocity for linear jogs, in , machine units per second.
# this controls where the jog slider is by default
DEFAULT_LINEAR_VELOCITY = 35.0
# MAX_LINEAR_VELOCITY: The maximum velocity for linear jogs, in machine units per second.
MAX_LINEAR_VELOCITY = 225 
# MIN_LINEAR_VELOCITY:  The approximate lowest value the jog slider in machine units per second.
MIN_LINEAR_VELOCITY = 30
DEFAULT_ANGULAR_VELOCITY = 12.000000
MAX_ANGULAR_VELOCITY = 180.000000
MIN_ANGULAR_VELOCITY = 1.666667
EDITOR = gedit
GEOMETRY = xyz

[FILTER]
PROGRAM_EXTENSION = .png,.gif,.jpg Greyscale Depth Image
PROGRAM_EXTENSION = .py Python Script
png = image-to-gcode
gif = image-to-gcode
jpg = image-to-gcode
py = python

[TASK]
TASK = milltask
CYCLE_TIME = 0.010

[RS274NGC]
PARAMETER_FILE = linuxcnc.var

[EMCMOT]
EMCMOT = motmod
COMM_TIMEOUT = 1.0
COMM_WAIT = 0.010
SERVO_PERIOD = 1000000

[HOSTMOT2]
# **** This is for info only ****
# DRIVER0=hm2_pci
# BOARD0=5i25
# DRIVER1=hm2_pci
# BOARD1=5i25

[HAL]
HALUI = halui
HALFILE = tree_4024.hal
POSTGUI_HALFILE = postgui_call_list.hal
SHUTDOWN = shutdown.hal

[HALUI]

[TRAJ]
AXES = 3
COORDINATES = X Y Z
LINEAR_UNITS = mm
ANGULAR_UNITS = degree
CYCLE_TIME = 0.010
# DEFAULT_VELOCITY: The initial rate for jogs of linear axes, in machine units per second. The value shown in Axis equals machine units per minute. 
# DEFAULT_VELOCITY controls where the jog speed slider will be by default
DEFAULT_VELOCITY = 100.0
# DEFAULT_ACCELERATION: In machines with nontrivial kinematics, the acceleration used for "teleop" (Cartesian space) jogs, in machine units per second per second. 
DEFAULT_ACCELERATION = 875.50
# MAX_VELOCITY: The maximum velocity for any axis or coordinated move, in machine units per second. a value of 5 equals 300 units per minute.
# Servo RPM = 1,500RPM 
# Distance per revolution: 10mm
# 1,500rpm * 10mm = 15,000 mm/minute
# 15,000 / 60 = 250 mm/sec
# 250mm sec of linear travel
# @ 70% DUTY CYCLE (ED) = 175 mm/sec (6.88 in/sec)
# @ 90% DUTY CYCLE (ED) = 225
MAX_VELOCITY = 225 
# MAX_ACCELERATION: The maximum acceleration for any axis or coordinated axis move, in machine units per second per second. 
MAX_ACCELERATION = 875.50
NO_FORCE_HOMING = 1 # do not force the machine to be homed for motion

[EMCIO]
EMCIO = io
CYCLE_TIME = 0.100
TOOL_TABLE = tool.tbl
TOOL_CHANGE_QUILL_UP = 1

#********************
# Axis X
#********************
[AXIS_0]

# XYZ axis are linear, not rotary.
TYPE = LINEAR
# HOME - determines the coordinate which the CNC machine will go to once it has calibrated itself using home-switches.
#      - If the HOME_OFFSET is -500 and HOME is "0.0" - the machine will move +500 machine units (millimeters) to reach coordinate 0.0
HOME = 0.0
# allowed deviation at high speeds (default 1.0)
FERROR = 5.0
# allowed position deviation at slow speeds in machine units (default 1.0)
MIN_FERROR = 20.0

##### VELOCITIES ################################
## The Acramatic Book states these values:
##   Feed Rate: 1-5000 mm/min (16.6 - 83.3 mm/sec)
##  Rapid Rate: 22k mm/min (366mm/sec)
## For Feed Rates - we want 10% of head room for 1,500 RPM drives at 10mm per revolution of linear travel
## we get a maximum linear travel rate in XYZ of 250mm/sec. With 10% overhead (90% of the max) we get 225mm/sec

# MAX_VELOCITY: The maximum velocity for any axis or coordinated move, in machine units per second.
MAX_VELOCITY = 225 
# MAX_ACCELERATION: The maximum acceleration for any axis or coordinated axis move, in machine units per second squared.
# Yaskawa X axis NOMINAL power = 118NM of power
# Table weight = 225KG = 500LBS
# ACCELERATION = FORCE / MASS
# 0.52 m/s = 118N / 225KG
# 0.52 m/s = 520 mm/s = 22.8 mm/s/s
# 80% of 22.8 = 875.50
# 70% of 22.8 = 15.96
# in machine units per second (units^2)
MAX_ACCELERATION = 875.50
# P is 210 in acramatic # default is 50
P = 0.45
# I is 150 # default is 0
I = 0
# D is 0.0050000 - default is 0.0
D = 0.0
# Default is 0.0
FF0 = 0.0
# FF0 
FF1 = 0.02
# FF1 Default is 0.0
FF2 = 0.00001
BIAS = 0.0
# Deadband is how-close in machine units is 'close-enough' to prevent hunting.
DEADBAND = 0.001
# the computed encoder velocity output voltage is clamped to this MAX_OUTPUT.
# MAX_OUTPUT should match OUTPUT_SCALE exactly
MAX_OUTPUT = 10.0
# This is encoder count per machine-unit (so 3276.8 counts per millimeter)
# ENCODER_SCALE = -3276.8 (must be negative for our machine, X axis)
ENCODER_SCALE = -3276.8
# This is offsets the output by a given value for velocity voltage, we don't use this.
OUTPUT_OFFSET = 0.0
# We don't scale our output voltage either, just -10 to +10 volts.
# output scale
# OUTPUT_SCALE = 10.0 (must be positive for our machine, X axis)
OUTPUT_SCALE = 10.0
# min velocity voltage is -10 volts DC
OUTPUT_MIN_LIMIT = -10.0
# max velocity voltage is +10 volts DC
OUTPUT_MAX_LIMIT = 10.0
# MIN_LIMIT defines the negative limit for axis movement in machine units (millimeters)
MIN_LIMIT = 0
# MAX_LIMIT defines the maximum limit for axis movement in machine units
MAX_LIMIT = 1000.0
# Home offset is the distance from the limit switch in machine units that will be considered ZERO
HOME_OFFSET = 0
# HOME_SEARCH_VEL - is millimeters/second - determines the direction and speed that the HOME SWITCH is searched for.
#                 - Our home switches are in the NEGATIVE direction, this moves the table to the RIGHT
HOME_SEARCH_VEL = -5.0
# HOME_LATCH_VEL - After the HOME SWITCH is found the machine backs-off the home-switch to determine the actual position.
#                - We back-off the swtich in the opposite direction of the search, this ensures we don't crash the machine.
#                - We backoff at a slow velocity to guarantee repeatable accuracy of the HOME POSITION.
HOME_LATCH_VEL = 0.01
# HOME_FINAL_VEL - Determines the rate in mm/sec that the machine moves back to "HOME" (0.0) after performing the HOME SEARCH.
HOME_FINAL_VEL = 20.0
# HOME_USE_INDEX - Uses the encoder index signal to ensure highly accurate HOME positioning.
#                - In the a closed loop encoder system its ideal to use this.
HOME_USE_INDEX = YES
# HOME_IGNORE_LIMITS - Causes linuxcnc to ignore limit switch input while HOMING - because we don't have a separate limit switch from our
#                      HOME switch we ignore the LIMIT switch input as it would prevent homing the machine.
HOME_IGNORE_LIMITS = YES
HOME_SEQUENCE = 0
HOME_IS_SHARED = 0 # the home switch is not shared, allow homing on multiple axis at once

#********************
# Axis Y
#********************

# Y AXIS
[AXIS_1]
TYPE = LINEAR
# HOME - determines the coordinate which the CNC machine will go to once it has calibrated itself using home-switches.
#      - If the HOME_OFFSET is -500 and HOME is "0.0" - the machine will move +500 machine units (millimeters) to reach coordinate 0.0
HOME = 0.0
# allowed deviation at high speeds (default 1.0)
FERROR = 3
# allowed position deviation at slow speeds in machine units (default 0.001)
MIN_FERROR = 10
MAX_VELOCITY = 225.0 # mm/sec
MAX_ACCELERATION = 875.50 
# P is 220 in acramatic # default is 50
P = 0.45
# I is 150 # default is 0
I = 0.0
# D - default is 0.0, ACRA: 0.006
D = 0.0
# Default is 0.0
FF0 = 0.0
# Default is 1.0
FF1 = 0.01998
# Default is 0.0
FF2 = 0.00003
# BIAS is 0.065
BIAS = 0.0
# Deadband is how-close in machine units is 'close-enough' to prevent hunting.
DEADBAND = 0.001
# the computed encoder velocity output voltage is clamped to this MAX_OUTPUT.
MAX_OUTPUT = 10.0
# This is encoder count per machine-unit (so 3276.8 counts per millimeter)
# !!! if Y axis is inverted we must change the sign on the OUTPUT_SCALE and ENCODER_SCALE from positive to negative.
#ENCODER_SCALE = 3276.8
ENCODER_SCALE = 3276.8
# This is offsets the output by a given value for velocity voltage, we don't use this.
OUTPUT_OFFSET = 0.0
# We don't scale our output voltage either, just -10 to +10 volts.
#OUTPUT_SCALE = -10.0
OUTPUT_SCALE = -10.0
# min velocity voltage is -10 volts DC
OUTPUT_MIN_LIMIT = -10.0
# max velocity voltage is +10 volts DC
OUTPUT_MAX_LIMIT = 10.0
# MIN_LIMIT defines the negative limit for axis movement in machine units (millimeters)
MIN_LIMIT = 0
# MAX_LIMIT defines the maximum limit for axis movement in machine units
MAX_LIMIT = 600
# Home offset is the distance from the limit switch in machine units that will be considered ZERO
HOME_OFFSET = 0
# HOME_SEARCH_VEL - is millimeters/second - determines the direction and speed that the HOME SWITCH is searched for.
#                 - Our home switches are in the NEGATIVE direction, this moves the table to the BACK
HOME_SEARCH_VEL = -5.0
# HOME_LATCH_VEL - After the HOME SWITCH is found the machine backs-off the home-switch to determine the actual position.
#                - We back-off the swtich in the opposite direction of the search, this ensures we don't crash the machine.
#                - We backoff at a slow velocity to guarantee repeatable accuracy of the HOME POSITION.
HOME_LATCH_VEL = 0.01
# HOME_FINAL_VEL -  Velocity in machine units per second from home latch position to home position.
                    If left at 0 or not included in the axis rapid velocity is used. Must be a positive number.
HOME_FINAL_VEL = 20
# HOME_USE_INDEX - Uses the encoder index signal to ensure highly accurate HOME positioning.
#                - In the a closed loop encoder system its ideal to use this.
HOME_USE_INDEX = YES
# HOME_IGNORE_LIMITS - Causes linuxcnc to ignore limit switch input while HOMING - because we don't have a separate limit switch from our
#                      HOME switch we ignore the LIMIT switch input as it would prevent homing the machine.
HOME_IGNORE_LIMITS = YES
HOME_SEQUENCE = 1
HOME_IS_SHARED = 0 # the home switch is not shared, allow homing on multiple axis at once

#********************
# Axis Z
#********************

# UP is POSITIVE (+) in the Z Axis
# LIMIT SWITCH / HOME (IS AT THE TOP)

[AXIS_2]
TYPE = LINEAR
# HOME - determines the coordinate which the CNC machine will go to once it has calibrated itself using home-switches.
#      - If the HOME_OFFSET is -500 and HOME is "0.0" - the machine will move +500 machine units (millimeters) to reach coordinate 0.0
HOME = 0.0
# allowed deviation at high speeds (default 1.0)
FERROR = 30.0
# allowed position deviation at slow speeds in machine units (default 0.001)
MIN_FERROR = 10.0
# MAX_VELOCITY: mm/sec
MAX_VELOCITY = 225
# MAX_ACCELERATION: mm/sec^2
MAX_ACCELERATION = 800.50 
P = 0.45
I = 0.0
D = 0.0
FF0 = 0.0
FF1 = 0.01998
FF2 = 0.00001
BIAS = 0.0
# Deadband is how-close in machine units is 'close-enough' to prevent hunting.
DEADBAND = 0.001
# the computed encoder velocity output voltage is clamped to this MAX_OUTPUT.
MAX_OUTPUT = 10
# This is encoder count per machine-unit (so 3276.8 counts per millimeter)
# The Z Axis encoder is inverted so we use a negative encoder scale
ENCODER_SCALE = -3276.8
# This is offsets the output by a given value for velocity voltage, we don't use this.
OUTPUT_OFFSET = 0.0
# We don't scale our output voltage either, just -10 to +10 volts.
OUTPUT_SCALE = 10.0
# min velocity voltage is -10 volts DC
OUTPUT_MIN_LIMIT = -10.0
# max velocity voltage is +10 volts DC
OUTPUT_MAX_LIMIT = 10.0
# MIN_LIMIT defines the negative limit for axis movement in machine units (millimeters)
MIN_LIMIT = 0
# MAX_LIMIT defines the maximum limit for axis movement in machine units
MAX_LIMIT = 560
# Home offset is the distance from the limit switch in machine units that will be considered ZERO
HOME_OFFSET = -560 # coordinate 0 is at the BOTTOM of the zaxis
# HOME_SEARCH_VEL - is millimeters/second - determines the direction and speed that the HOME SWITCH is searched for.
#                 - The Z Axis (headstock) home switch is in the positive direction (UP)
HOME_SEARCH_VEL = 5.0
# HOME_LATCH_VEL - After the HOME SWITCH is found the machine backs-off the home-switch to determine the actual position.
#                - We back-off the swtich in the opposite direction of the search, this ensures we don't crash the machine.
#                - We backoff at a slow velocity to guarantee repeatable accuracy of the HOME POSITION.
HOME_LATCH_VEL = 0.01
# HOME_FINAL_VEL - Determines the rate in mm/sec that the machine moves back to "HOME" (0.0) after performing the HOME SEARCH.
HOME_FINAL_VEL = 20
# HOME_USE_INDEX - Uses the encoder index signal to ensure highly accurate HOME positioning.
#                - In the a closed loop encoder system its ideal to use this.
HOME_USE_INDEX = YES
# HOME_IGNORE_LIMITS - Causes linuxcnc to ignore limit switch input while HOMING - because we don't have a separate limit switch from our
#                      HOME switch we ignore the LIMIT switch input as it would prevent homing the machine.
HOME_IGNORE_LIMITS = YES
HOME_SEQUENCE = 2
HOME_IS_SHARED = 0 # the home switch is not shared, allow homing on multiple axis at once

#********************
# Spindle
#********************
[SPINDLE_9]

P = 1.8
I = 0.0
D = 0.0
FF0 = 0.0
FF1 = 1.0
FF2 = 0.0
BIAS = 0.0
DEADBAND = 0.1
MAX_OUTPUT = 8000.0
# encoder pulses per revolution
# our spindle generates 4096 pulses per revolution, or 11.7 per degree
ENCODER_SCALE = 4096.0
OUTPUT_SCALE = 8000.0
# Our spindle uses +10 and -10 volt connection to determine direction.
OUTPUT_MIN_LIMIT = -8000.0
OUTPUT_MAX_LIMIT = 8000.0


